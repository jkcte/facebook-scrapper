self.window=self;self.__annotator=function(a){return a};self.__d_stub=[];self.__d=function(a,b,c,d){self.__d_stub.push([a,b,c,d])};self.__rl_stub=[];self.requireLazy=function(){self.__rl_stub.push(arguments)};function processJSEnv(a){window.Env=window.Env||{},Object.assign(window.Env,a)}function generateWorkerID(){var a=Math.floor(Math.random()*Math.pow(36,6));a=a.toString(36);return a.length>=6?a:"0".repeat(6-a.length)+a}var importWrapper=function(a){return import(a)};self.bl_worker_import_wrapper=importWrapper;function processHRP(a,b,c){b===void 0&&(b=function(){});var d=a.hsrp;if(d==null)throw new Error("[WebWorkerV2 Init] Missing hsrp");var e=a.jsmods,f=d.hsdp,g=d.hblp,h=g==null?void 0:g.rsrcMap;if(h==null)throw new Error("[WebWorkerV2 Init] Missing resource map");var i=function(a,d){return new Promise(function(e,f){var g={},i={};d.forEach(function(a){var b=h[a];if(!b)return;g[a]=h[a];b.type==="js"&&(i[a]=importWrapper(b.src))});requireLazy.call(null,["Bootloader"],function(a){a.notifyManuallyLoadedResourcesInWorker(g,i)});void Promise.all(Object.values(i)).then(function(){b(a),e()},function(){c==null||c(a+"_failed")})})},j=a.tieredResources;if(j==null)throw new Error("[WebWorkerV2 Init] Missing resources");void Promise.all([i("tier_one_loaded",j.r),i("tier_two_loaded",j.rdfds)]).then(function(){return i("tier_three_loaded",j.rds)});requireLazy.call(null,["HasteSupportData","ServerJS"],function(a,c){b("hsdp_start"),f&&a.handle(f),e&&new c().handle(e),b("hsdp_end")});requireLazy.call(null,["Bootloader"],function(a){b("hblp_start"),typeof a.markSupportDataReadyForImmediateBootloads==="function"&&a.markSupportDataReadyForImmediateBootloads(),g&&a.handlePayload(g),b("hblp_end")})}var initialized=!1;if("SharedWorkerGlobalScope"in self&&self instanceof self.SharedWorkerGlobalScope){var portsBuffer=[],messageBuffer=[],unsubscribeCleanupFunctions=[],hasRun=!1,shutdownWorkerPostRun=null,SHARED_WORKER_BROADCAST_CHANNEL="shared_worker_broadcast_channel",use_broadcast=!1,acquire_lock_with_worker_id=!1;self.location&&(use_broadcast=new URL(location.href).searchParams.get("use_broadcast")==="true",acquire_lock_with_worker_id=new URL(location.href).searchParams.get("with_worker_id_lock")==="true");var selfTerminate=function(a,b){try{portsBuffer.forEach(function(c){return c.postMessage({type:"self-terminate",response:{from:"init-v2-module",reason:a,error:b,workerID:self.worker_id}})})}catch(a){}self.close()};self.setTimeout(function(){hasRun||selfTerminate("worker-init-script-timeout")},3e5);self.worker_id==null&&(self.worker_id=generateWorkerID());var lockWaitingPromise=acquire_lock_with_worker_id&&self.LockManager!=null&&self.navigator.locks instanceof self.LockManager?new Promise(function(a,b){self.navigator.locks.request("sw-lock-"+self.name+"-"+self.worker_id,function(){a();return new Promise(function(){})})}):Promise.resolve(),connectListener=function(a){var b=a.ports[0],c=function(c){var d=c.data;typeof d==="object"&&(d==null?void 0:d.type)==="ww-connection-ack"&&void lockWaitingPromise.finally(function(){b.postMessage({type:"connection-ack",response:{from:"initScriptV2",workerID:self.worker_id,hrpStatus:initialized?"initialized":"no-hrp"}})});if(!initialized&&typeof d==="object"&&(d==null?void 0:d.type)==="ww-hrp-init"&&typeof d.hrp==="object"){d.is_dev===!0&&(self.__DEV__=1);try{var e=function(a){b.postMessage({type:"worker-init-mark",response:{point:a}})};e("hrp_init_start");d.js_env!=null&&processJSEnv(d.js_env);processHRP(d.hrp,e,selfTerminate);initialized=!0;b.postMessage({type:"ww-hrp-init",response:{}})}catch(a){selfTerminate("hrp-init-failed",a.message)}}messageBuffer.push({e:c,port:b})};b.addEventListener("message",c);unsubscribeCleanupFunctions.push(function(){return b.removeEventListener("message",c)});b.start();portsBuffer.push(b)};self.addEventListener("connect",connectListener);unsubscribeCleanupFunctions.push(function(){return self.removeEventListener("connect",connectListener)});self.shared_worker_bootstrap_buffer=function(a){hasRun;hasRun=!0;while(unsubscribeCleanupFunctions.length)try{var b=unsubscribeCleanupFunctions.pop();b()}catch(a){}b=portsBuffer;var c=messageBuffer;messageBuffer=[];portsBuffer=[];shutdownWorkerPostRun=a;return{ports:b,messages:c}};if(use_broadcast&&self.BroadcastChannel){var broadcastChannel=new self.BroadcastChannel(SHARED_WORKER_BROADCAST_CHANNEL+"_"+self.name);broadcastChannel.onmessage=function(a){a=a.data;if(typeof a==="object"&&(a==null?void 0:a.type)==="terminate"){a=typeof a.reason==="string"?a.reason:"unknown";shutdownWorkerPostRun!=null?shutdownWorkerPostRun(a):selfTerminate(a)}}}}else{var initMessageHandler=function(a){a=a.data;typeof a==="object"&&(a==null?void 0:a.type)==="ww-hrp-init"&&typeof a.hrp==="object"&&(a.is_dev===!0&&(self.__DEV__=1),self.removeEventListener("message",initMessageHandler),a.js_env!=null&&processJSEnv(a.js_env),processHRP(a.hrp))};self.addEventListener("message",initMessageHandler)}